<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="warp.render" href="render.html" /><link rel="prev" title="warp.sparse" href="sparse.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>warp.fem - Warp 1.0.2</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a91381f3" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-title-font-size: 100%;
  --admonition-font-size: 100%;
  --color-api-pre-name: #4e9a06;
  --color-api-name: #4e9a06;
  --color-admonition-title--seealso: #ffffff;
  --color-admonition-title-background--seealso: #448aff;
  --color-admonition-title-background--note: #76b900;
  --color-admonition-title--note: #ffffff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-admonition-title-background--note: #535353;
  --color-admonition-title--note: #ffffff;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-admonition-title-background--note: #535353;
  --color-admonition-title--note: #ffffff;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Warp 1.0.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo-light-mode.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo-dark-mode.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Warp 1.0.2</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="devices.html">Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="allocators.html">Allocators</a></li>
<li class="toctree-l1"><a class="reference internal" href="concurrency.html">Concurrency</a></li>
<li class="toctree-l1"><a class="reference internal" href="generics.html">Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="interoperability.html">Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Runtime Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../limitations.html">Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Runtime Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Kernel Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulation Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sim.html">warp.sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">warp.sparse</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">warp.fem</a></li>
<li class="toctree-l1"><a class="reference internal" href="render.html">warp.render</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVIDIA/warp">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/warp-lang">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discord.com/channels/827959428476174346/953756751977648148">Discord</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="warp-fem">
<h1>warp.fem<a class="headerlink" href="#warp-fem" title="Link to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">warp.fem</span></code> module is designed to facilitate solving physical systems described as differential
equations. For example, it can solve PDEs for diffusion, convection, fluid flow, and elasticity problems
using finite-element-based (FEM) Galerkin methods, and allows users to quickly experiment with various FEM
formulations and discretization schemes.</p>
<section id="integrands">
<h2>Integrands<a class="headerlink" href="#integrands" title="Link to this heading">#</a></h2>
<p>The core functionality of the FEM toolkit is the ability to integrate constant, linear, and bilinear forms
over various domains and using arbitrary interpolation basis.</p>
<p>The main mechanism is the <a class="reference internal" href="#warp.fem.integrand" title="warp.fem.integrand"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrand()</span></code></a> decorator, for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@integrand</span>
<span class="k">def</span> <span class="nf">linear_form</span><span class="p">(</span>
    <span class="n">s</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
    <span class="n">v</span><span class="p">:</span> <span class="n">Field</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="nd">@integrand</span>
<span class="k">def</span> <span class="nf">diffusion_form</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="n">Field</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Field</span><span class="p">,</span> <span class="n">nu</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">wp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
        <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span>
        <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Integrands are normal warp kernels, meaning any usual warp function can be used.
However, they accept a few special parameters:</p>
<blockquote>
<div><ul>
<li><p><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sample</span></code></a> contains information about the current integration sample point, such as the element index and coordinates in element.</p></li>
<li><p><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> designates an abstract field, which will be replaced at call time by the actual field type: for instance a <a class="reference internal" href="#warp.fem.DiscreteField" title="warp.fem.DiscreteField"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscreteField</span></code></a>, <a class="reference internal" href="#warp.fem.field.TestField" title="warp.fem.field.TestField"><code class="xref py py-class docutils literal notranslate"><span class="pre">field.TestField</span></code></a> or <a class="reference internal" href="#warp.fem.field.TrialField" title="warp.fem.field.TrialField"><code class="xref py py-class docutils literal notranslate"><span class="pre">field.TrialField</span></code></a> defined over an arbitrary <a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.FunctionSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code></a>.
A field <cite>u</cite> can be evaluated at a given sample <cite>s</cite> using the <a class="reference internal" href="#warp.fem.inner" title="warp.fem.inner"><code class="xref py py-func docutils literal notranslate"><span class="pre">inner()</span></code></a> operator, i.e, <code class="docutils literal notranslate"><span class="pre">inner(u,</span> <span class="pre">s)</span></code>, or as a shortcut using the usual call operator, <code class="docutils literal notranslate"><span class="pre">u(s)</span></code>.
Several other operators are available, such as <a class="reference internal" href="#warp.fem.grad" title="warp.fem.grad"><code class="xref py py-func docutils literal notranslate"><span class="pre">grad()</span></code></a>; see the <a class="reference internal" href="#operators"><span class="std std-ref">Operators</span></a> section.</p></li>
<li><p><a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Domain</span></code></a> designates an abstract integration domain. Several operators are also provided for domains, for example in the example below evaluating the normal at the current sample position:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@integrand</span>
<span class="k">def</span> <span class="nf">boundary_form</span><span class="p">(</span>
    <span class="n">s</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
    <span class="n">domain</span><span class="p">:</span> <span class="n">Domain</span><span class="p">,</span>
    <span class="n">u</span><span class="p">:</span> <span class="n">Field</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">nor</span> <span class="o">=</span> <span class="n">normal</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">nor</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>Integrands cannot be used directly with <a class="reference internal" href="runtime.html#warp.launch" title="warp.launch"><code class="xref py py-func docutils literal notranslate"><span class="pre">warp.launch()</span></code></a>, but must be called through <a class="reference internal" href="#warp.fem.integrate" title="warp.fem.integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a> or <a class="reference internal" href="#warp.fem.interpolate" title="warp.fem.interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">interpolate()</span></code></a> instead.
The root integrand (<cite>integrand</cite> argument passed to <a class="reference internal" href="#warp.fem.integrate" title="warp.fem.integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a> or <a class="reference internal" href="#warp.fem.interpolate" title="warp.fem.interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">interpolate()</span></code></a> call) will automatically get passed <a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sample</span></code></a> and <a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Domain</span></code></a> parameters.
<a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> parameters must be passed as a dictionary in the <cite>fields</cite> argument of the launcher function, and all other standard Warp types arguments must be
passed as a dictionary in the <cite>values</cite> argument of the launcher function, for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">diffusion_form</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">test</span><span class="p">},</span> <span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;nu&quot;</span><span class="p">:</span> <span class="n">viscosity</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="basic-workflow">
<h2>Basic workflow<a class="headerlink" href="#basic-workflow" title="Link to this heading">#</a></h2>
<p>The typical steps for solving a linear PDE are as follow:</p>
<blockquote>
<div><ul class="simple">
<li><p>Define a <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a> (grid, mesh, etc). At the moment, 2D and 3D regular grids, triangle, quadrilateral, tetrahedron and hexahedron meshes are supported.</p></li>
<li><p>Define one or more <a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.FunctionSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code></a>, by equipping the geometry elements with shape functions. See <a class="reference internal" href="#warp.fem.make_polynomial_space" title="warp.fem.make_polynomial_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_polynomial_space()</span></code></a>. At the moment, continuous/discontinuous Lagrange (<span class="math notranslate nohighlight">\(P_{k[d]}, Q_{k[d]}\)</span>) and Serendipity (<span class="math notranslate nohighlight">\(S_k\)</span>) shape functions of order <span class="math notranslate nohighlight">\(k \leq 3\)</span> are supported.</p></li>
<li><p>Define an integration <a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.GeometryDomain"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometryDomain</span></code></a>, for instance the geometry’s cells (<a class="reference internal" href="#warp.fem.Cells" title="warp.fem.Cells"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cells</span></code></a>) or boundary sides (<a class="reference internal" href="#warp.fem.BoundarySides" title="warp.fem.BoundarySides"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoundarySides</span></code></a>).</p></li>
<li><p>Integrate linear forms to build the system’s right-hand-side. Define a test function over the function space using <a class="reference internal" href="#warp.fem.make_test" title="warp.fem.make_test"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_test()</span></code></a>,
a <a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.Quadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quadrature</span></code></a> formula (or let the module choose one based on the function space degree), and call <a class="reference internal" href="#warp.fem.integrate" title="warp.fem.integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a> with the linear form integrand.
The result is a <a class="reference internal" href="runtime.html#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.array</span></code></a> containing the integration result for each of the function space degrees of freedom.</p></li>
<li><p>Integrate bilinear forms to build the system’s left-hand-side. Define a trial function over the function space using <a class="reference internal" href="#warp.fem.make_trial" title="warp.fem.make_trial"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_trial()</span></code></a>,
then call <a class="reference internal" href="#warp.fem.integrate" title="warp.fem.integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a> with the bilinear form integrand.
The result is a <a class="reference internal" href="sparse.html#warp.sparse.BsrMatrix" title="warp.sparse.BsrMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.sparse.BsrMatrix</span></code></a> containing the integration result for each pair of test and trial function space degrees of freedom.
Note that the trial and test functions do not have to be defined over the same function space, so that Mixed FEM is supported.</p></li>
<li><p>Solve the resulting linear system using the solver of your choice</p></li>
</ul>
</div></blockquote>
<p>The following excerpt from the introductory example <code class="docutils literal notranslate"><span class="pre">warp/examples/fem/example_diffusion.py</span></code> outlines this procedure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grid geometry</span>
<span class="n">geo</span> <span class="o">=</span> <span class="n">Grid2D</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cell_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Domain and function spaces</span>
<span class="n">domain</span> <span class="o">=</span> <span class="n">Cells</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geo</span><span class="p">)</span>
<span class="n">scalar_space</span> <span class="o">=</span> <span class="n">make_polynomial_space</span><span class="p">(</span><span class="n">geo</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Right-hand-side (forcing term)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">make_test</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">scalar_space</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">linear_form</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">test</span><span class="p">})</span>

<span class="c1"># Weakly-imposed boundary conditions on Y sides</span>
<span class="n">boundary</span> <span class="o">=</span> <span class="n">BoundarySides</span><span class="p">(</span><span class="n">geo</span><span class="p">)</span>
<span class="n">bd_test</span> <span class="o">=</span> <span class="n">make_test</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">scalar_space</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">boundary</span><span class="p">)</span>
<span class="n">bd_trial</span> <span class="o">=</span> <span class="n">make_trial</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">scalar_space</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">boundary</span><span class="p">)</span>
<span class="n">bd_matrix</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">y_mass_form</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="n">bd_trial</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">bd_test</span><span class="p">})</span>

<span class="c1"># Diffusion form</span>
<span class="n">trial</span> <span class="o">=</span> <span class="n">make_trial</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">scalar_space</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">diffusion_form</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">test</span><span class="p">},</span> <span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;nu&quot;</span><span class="p">:</span> <span class="n">viscosity</span><span class="p">})</span>

<span class="c1"># Assemble linear system (add diffusion and boundary condition matrices)</span>
<span class="n">bsr_axpy</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">bd_matrix</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">boundary_strength</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Solve linear system using Conjugate Gradient</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>
<span class="n">bsr_cg</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#warp.fem.integrate" title="warp.fem.integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a> function does not check that the passed integrands are actually linear or bilinear forms; it is up to the user to ensure that they are.
To solve non-linear PDEs, one can use an iterative procedure and pass the current value of the studied function <a class="reference internal" href="#warp.fem.DiscreteField" title="warp.fem.DiscreteField"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscreteField</span></code></a> argument to the integrand, on which
arbitrary operations are permitted. However, the result of the form must remain linear in the test and trial fields.</p>
</div>
</section>
<section id="introductory-examples">
<h2>Introductory examples<a class="headerlink" href="#introductory-examples" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">warp.fem</span></code> ships with a list of examples in the <code class="docutils literal notranslate"><span class="pre">warp/examples/fem</span></code> directory illustrating common model problems.</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">example_diffusion.py</span></code>: 2D diffusion with homogeneous Neumann and Dirichlet boundary conditions</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">example_diffusion_3d.py</span></code>: 3D variant of the diffusion problem</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">example_convection_diffusion.py</span></code>: 2D convection-diffusion using semi-Lagrangian advection</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">example_diffusion_dg0.py</span></code>: 2D convection-diffusion using finite-volume and upwind transport</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">example_diffusion_dg.py</span></code>: 2D convection-diffusion using Discontinuous Galerkin with upwind transport and Symmetric Interior Penalty</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">example_stokes.py</span></code>: 2D incompressible Stokes flow using mixed <span class="math notranslate nohighlight">\(P_k/P_{k-1}\)</span> or <span class="math notranslate nohighlight">\(Q_k/P_{(k-1)d}\)</span> elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">example_navier_stokes.py</span></code>: 2D Navier-Stokes flow using mixed <span class="math notranslate nohighlight">\(P_k/P_{k-1}\)</span> elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">example_mixed_elasticity.py</span></code>: 2D linear elasticity using mixed continuous/discontinuous <span class="math notranslate nohighlight">\(S_k/P_{(k-1)d}\)</span> elements</p></li>
</ul>
</div></blockquote>
</section>
<section id="advanced-usages">
<h2>Advanced usages<a class="headerlink" href="#advanced-usages" title="Link to this heading">#</a></h2>
<section id="high-order-curved-geometries">
<h3>High-order (curved) geometries<a class="headerlink" href="#high-order-curved-geometries" title="Link to this heading">#</a></h3>
<p>It is possible to convert any <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a> (grids and explicit meshes) into a curved, high-order variant by deforming them
with an arbitrary-order displacement field using the <a class="reference internal" href="#warp.fem.DiscreteField.make_deformed_geometry" title="warp.fem.DiscreteField.make_deformed_geometry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_deformed_geometry()</span></code></a> method.
The process looks as follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a base geometry</span>
<span class="n">base_geo</span> <span class="o">=</span> <span class="n">fem</span><span class="o">.</span><span class="n">Grid3D</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>

<span class="c1"># Define a displacement field on the base geometry</span>
<span class="n">deformation_space</span> <span class="o">=</span> <span class="n">fem</span><span class="o">.</span><span class="n">make_polynomial_space</span><span class="p">(</span><span class="n">base_geo</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">deformation_degree</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">)</span>
<span class="n">deformation_field</span> <span class="o">=</span> <span class="n">deformation_space</span><span class="o">.</span><span class="n">make_field</span><span class="p">()</span>

<span class="c1"># Populate the field value by interpolating an expression</span>
<span class="n">fem</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">deformation_field_expr</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">deformation_field</span><span class="p">)</span>

<span class="c1"># Construct the deformed geometry from the displacement field</span>
<span class="n">deform_geo</span> <span class="o">=</span> <span class="n">deformation_field</span><span class="o">.</span><span class="n">make_deformed_geometry</span><span class="p">()</span>

<span class="c1"># Define new function spaces on the deformed geometry</span>
<span class="n">scalar_space</span> <span class="o">=</span> <span class="n">fem</span><span class="o">.</span><span class="n">make_polynomial_space</span><span class="p">(</span><span class="n">deformed_geo</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">scalar_space_degree</span><span class="p">)</span>
</pre></div>
</div>
<p>See also <code class="docutils literal notranslate"><span class="pre">example_deformed_geometry.py</span></code> for a complete example.</p>
</section>
<section id="particle-based-quadrature">
<h3>Particle-based quadrature<a class="headerlink" href="#particle-based-quadrature" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="#warp.fem.PicQuadrature" title="warp.fem.PicQuadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">PicQuadrature</span></code></a> provides a way to define Particle-In-Cell quadratures from a set or arbitrary particles,
which can be helpful to develop MPM-like methods.
The particles are automatically bucketed to the geometry cells when the quadrature is initialized.
This is illustrated by the <code class="docutils literal notranslate"><span class="pre">example_stokes_transfer.py</span></code> and <code class="docutils literal notranslate"><span class="pre">example_apic_fluid.py</span></code> examples.</p>
</section>
<section id="partitioning">
<h3>Partitioning<a class="headerlink" href="#partitioning" title="Link to this heading">#</a></h3>
<p>The FEM toolkit makes it possible to perform integration on a subset of the domain elements,
possibly re-indexing degrees of freedom so that the linear system contains the local ones only.
This is useful for distributed computation (see <code class="docutils literal notranslate"><span class="pre">warp/examples/fem/example_diffusion_mgpu.py</span></code>), or simply to limit the simulation domain to a subset of active cells (see <code class="docutils literal notranslate"><span class="pre">warp/examples/fem/example_stokes_transfer.py</span></code>).</p>
<p>A partition of the simulation geometry can be defined using subclasses of <a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.GeometryPartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometryPartition</span></code></a>
such as <a class="reference internal" href="#warp.fem.LinearGeometryPartition" title="warp.fem.LinearGeometryPartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearGeometryPartition</span></code></a>  or <a class="reference internal" href="#warp.fem.ExplicitGeometryPartition" title="warp.fem.ExplicitGeometryPartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitGeometryPartition</span></code></a>.</p>
<p>Function spaces can then be partitioned according to the geometry partition using <a class="reference internal" href="#warp.fem.make_space_partition" title="warp.fem.make_space_partition"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_space_partition()</span></code></a>.
The resulting <a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.SpacePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpacePartition</span></code></a> object allows translating between space-wide and partition-wide node indices,
and differentiating interior, frontier and exterior nodes.</p>
</section>
<section id="memory-management">
<h3>Memory management<a class="headerlink" href="#memory-management" title="Link to this heading">#</a></h3>
<p>Several <code class="docutils literal notranslate"><span class="pre">warp.fem</span></code> functions require allocating temporary buffers to perform their computations.
If such functions are called many times in a tight loop, those many allocations and de-allocations may degrade performance.
To overcome this issue, a <a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><code class="xref py py-class docutils literal notranslate"><span class="pre">cache.TemporaryStore</span></code></a> object may be created to persist and reuse temporary allocations across calls,
either globally using <a class="reference internal" href="#warp.fem.set_default_temporary_store" title="warp.fem.set_default_temporary_store"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_default_temporary_store()</span></code></a> or at a per-function granularity using the corresponding argument.</p>
</section>
</section>
<section id="operators">
<span id="id1"></span><h2>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.position">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><span class="pre">Domain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.position" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the world position of the sample point <cite>s</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.normal">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><span class="pre">Domain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.normal" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the element normal at the sample point <cite>s</cite>. Null for interior points.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.lookup">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><span class="pre">Domain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.lookup" title="Link to this definition">#</a></dt>
<dd><p>Looks-up the sample point corresponding to a world position <cite>x</cite>, projecting to the closest point on the domain.</p>
<dl class="simple">
<dt>Arg:</dt><dd><p>x: world position of the point to look-up in the geometry
guess: (optional) <a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sample</span></code></a> initial guess, may help perform the query</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Currently this operator is only fully supported for <a class="reference internal" href="#warp.fem.Grid2D" title="warp.fem.Grid2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid2D</span></code></a> and <a class="reference internal" href="#warp.fem.Grid3D" title="warp.fem.Grid3D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid3D</span></code></a> geometries.
For <code class="xref py py-class docutils literal notranslate"><span class="pre">TriangleMesh2D</span></code> and <a class="reference internal" href="#warp.fem.Tetmesh" title="warp.fem.Tetmesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tetmesh</span></code></a> geometries, the operator requires providing <cite>guess</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.measure">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><span class="pre">Domain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.measure" title="Link to this definition">#</a></dt>
<dd><p>Returns the measure (volume, area, or length) determinant of an element at a sample point <cite>s</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.measure_ratio">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">measure_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><span class="pre">Domain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.measure_ratio" title="Link to this definition">#</a></dt>
<dd><p>Returns the maximum ratio between the measure of this element and that of higher-dimensional neighbours.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.deformation_gradient">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">deformation_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><span class="pre">Domain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.deformation_gradient" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the gradient of the domain position with respect to the element reference space at the sample point <cite>s</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.degree">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">degree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.degree" title="Link to this definition">#</a></dt>
<dd><p>Polynomial degree of a field</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.inner">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">inner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.inner" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the field at a sample point <cite>s</cite>. On oriented sides, uses the inner element</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.outer">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">outer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.outer" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the field at a sample point <cite>s</cite>. On oriented sides, uses the outer element. On interior points and on domain boundaries, this is equivalent to <a class="reference internal" href="#warp.fem.inner" title="warp.fem.inner"><code class="xref py py-func docutils literal notranslate"><span class="pre">inner()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.grad">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.grad" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the field gradient at a sample point <cite>s</cite>. On oriented sides, uses the inner element</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.grad_outer">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">grad_outer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.grad_outer" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the field gradient at a sample point <cite>s</cite>. On oriented sides, uses the outer element. On interior points and on domain boundaries, this is equivalent to <a class="reference internal" href="#warp.fem.grad" title="warp.fem.grad"><code class="xref py py-func docutils literal notranslate"><span class="pre">grad()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.div">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.div" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the field divergence at a sample point <cite>s</cite>. On oriented sides, uses the inner element</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.div_outer">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">div_outer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.div_outer" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the field divergence at a sample point <cite>s</cite>. On oriented sides, uses the outer element. On interior points and on domain boundaries, this is equivalent to <a class="reference internal" href="#warp.fem.div" title="warp.fem.div"><code class="xref py py-func docutils literal notranslate"><span class="pre">div()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.at_node">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">at_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.at_node" title="Link to this definition">#</a></dt>
<dd><p>For a Test or Trial field, returns a copy of the Sample <cite>s</cite> moved to the coordinates of the node being evaluated</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.D">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.D" title="Link to this definition">#</a></dt>
<dd><p>Symmetric part of the (inner) gradient of the field at <cite>s</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.curl">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">curl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.curl" title="Link to this definition">#</a></dt>
<dd><p>Skew part of the (inner) gradient of the field at <cite>s</cite>, as a vector such that <code class="docutils literal notranslate"><span class="pre">wp.cross(curl(u),</span> <span class="pre">v)</span> <span class="pre">=</span> <span class="pre">skew(grad(u))</span> <span class="pre">v</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.jump">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">jump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.jump" title="Link to this definition">#</a></dt>
<dd><p>Jump between inner and outer element values on an interior side. Zero for interior points or domain boundaries</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.average">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.average" title="Link to this definition">#</a></dt>
<dd><p>Average between inner and outer element values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.grad_jump">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">grad_jump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.grad_jump" title="Link to this definition">#</a></dt>
<dd><p>Jump between inner and outer element gradients on an interior side. Zero for interior points or domain boundaries</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.grad_average">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">grad_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Field" title="warp.fem.Field"><span class="pre">Field</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#warp.fem.Sample" title="warp.fem.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.grad_average" title="Link to this definition">#</a></dt>
<dd><p>Average between inner and outer element gradients</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.operator.operator">
<span class="sig-prename descclassname"><span class="pre">warp.fem.operator.</span></span><span class="sig-name descname"><span class="pre">operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.operator.operator" title="Link to this definition">#</a></dt>
<dd><p>Decorator for functions operating on Field-like or Domain-like data inside warp.fem integrands</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>resolver</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a>) – </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="integration">
<h2>Integration<a class="headerlink" href="#integration" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.integrate">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodal=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accumulate_dtype=&lt;class</span> <span class="pre">'warp.types.float64'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dtype=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_options={}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.integrate" title="Link to this definition">#</a></dt>
<dd><p>Integrates a constant, linear or bilinear form, and returns a scalar, array, or sparse matrix, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integrand</strong> (<em>Integrand</em>) – Form to be integrated, must have <a class="reference internal" href="#warp.fem.integrand" title="warp.fem.integrand"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrand()</span></code></a> decorator</p></li>
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a><em> | </em><em>None</em>) – Integration domain. If None, deduced from fields</p></li>
<li><p><strong>quadrature</strong> (<a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.quadrature.quadrature.Quadrature"><em>Quadrature</em></a><em> | </em><em>None</em>) – Quadrature formula. If None, deduced from domain and fields degree.</p></li>
<li><p><strong>nodal</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – For linear or bilinear form only, use the test function nodes as the quadrature points. Assumes Lagrange interpolation functions are used, and no differential or DG operator is evaluated on the test or trial functions.</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference internal" href="#warp.fem.FieldLike" title="warp.fem.field.field.FieldLike"><em>FieldLike</em></a><em>]</em>) – Discrete, test, and trial fields to be passed to the integrand. Keys in the dictionary must match integrand parameter names.</p></li>
<li><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><em>Any</em></a><em>]</em>) – Additional variable values to be passed to the integrand, can be of any type accepted by warp kernel launches. Keys in the dictionary must match integrand parameter names.</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – shared pool from which to allocate temporary arrays</p></li>
<li><p><strong>accumulate_dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><em>type</em></a>) – Scalar type to be used for accumulating integration samples</p></li>
<li><p><strong>output</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><a class="reference internal" href="sparse.html#warp.sparse.BsrMatrix" title="warp.sparse.BsrMatrix"><em>BsrMatrix</em></a><em> | </em><em>None</em>) – Sparse matrix or warp array into which to store the result of the integration</p></li>
<li><p><strong>output_dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><em>type</em></a><em> | </em><em>None</em>) – Scalar type for returned results in <cite>output</cite> is not provided. If None, defaults to <cite>accumulate_dtype</cite></p></li>
<li><p><strong>device</strong> – Device on which to perform the integration</p></li>
<li><p><strong>kernel_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><em>Any</em></a><em>]</em>) – Overloaded options to be passed to the kernel builder (e.g, <code class="docutils literal notranslate"><span class="pre">{&quot;enable_backward&quot;:</span> <span class="pre">True}</span></code>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.interpolate">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.interpolate" title="Link to this definition">#</a></dt>
<dd><p>Interpolates a function at a finite set of sample points and optionally assigns the result to a discrete field or a raw warp array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integrand</strong> (<em>Integrand</em>) – Function to be interpolated, must have <a class="reference internal" href="#warp.fem.integrand" title="warp.fem.integrand"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrand()</span></code></a> decorator</p></li>
<li><p><strong>dest</strong> (<a class="reference internal" href="#warp.fem.DiscreteField" title="warp.fem.field.field.DiscreteField"><em>DiscreteField</em></a><em> | </em><a class="reference internal" href="#warp.fem.field.FieldRestriction" title="warp.fem.field.restriction.FieldRestriction"><em>FieldRestriction</em></a><em> | </em><a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – <p>Where to store the interpolation result. Can be either</p>
<ul>
<li><p>a <a class="reference internal" href="#warp.fem.DiscreteField" title="warp.fem.DiscreteField"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscreteField</span></code></a>, or restriction of a discrete field to a domain (from <a class="reference internal" href="#warp.fem.make_restriction" title="warp.fem.make_restriction"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_restriction()</span></code></a>). In this case, interpolation will be performed at each node.</p></li>
<li><p>a normal warp array. In this case, the <cite>quadrature</cite> argument defining the interpolation locations must be provided and the result of the <cite>integrand</cite> at each quadrature point will be assigned to the array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. In this case, the <cite>quadrature</cite> argument must also be provided and the <cite>integrand</cite> function is responsible for dealing with the interpolation result.</p></li>
</ul>
</p></li>
<li><p><strong>quadrature</strong> (<a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.quadrature.quadrature.Quadrature"><em>Quadrature</em></a><em> | </em><em>None</em>) – Quadrature formula defining the interpolation samples if <cite>dest</cite> is not a discrete field or field restriction.</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference internal" href="#warp.fem.FieldLike" title="warp.fem.field.field.FieldLike"><em>FieldLike</em></a><em>]</em>) – Discrete fields to be passed to the integrand. Keys in the dictionary must match integrand parameters names.</p></li>
<li><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><em>Any</em></a><em>]</em>) – Additional variable values to be passed to the integrand, can be of any type accepted by warp kernel launches. Keys in the dictionary must match integrand parameter names.</p></li>
<li><p><strong>device</strong> – Device on which to perform the interpolation</p></li>
<li><p><strong>kernel_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><em>Any</em></a><em>]</em>) – Overloaded options to be passed to the kernel builder (e.g, <code class="docutils literal notranslate"><span class="pre">{&quot;enable_backward&quot;:</span> <span class="pre">True}</span></code>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.integrand">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">integrand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.integrand" title="Link to this definition">#</a></dt>
<dd><p>Decorator for functions to be integrated (or interpolated) using warp.fem</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><em>Callable</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Sample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Sample</span></span><a class="headerlink" href="#warp.fem.Sample" title="Link to this definition">#</a></dt>
<dd><p>Per-sample point context for evaluating fields and related operators in integrands.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Field">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Field</span></span><a class="headerlink" href="#warp.fem.Field" title="Link to this definition">#</a></dt>
<dd><p>Tag for field-like integrand arguments</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Domain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Domain</span></span><a class="headerlink" href="#warp.fem.Domain" title="Link to this definition">#</a></dt>
<dd><p>Tag for domain-like integrand arguments</p>
</dd></dl>

</section>
<section id="geometry">
<h2>Geometry<a class="headerlink" href="#geometry" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Grid2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Grid2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_lo=&lt;warp.types.vec2f</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_hi=&lt;warp.types.vec2f</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Grid2D" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
<p>Two-dimensional regular grid geometry</p>
<p>Constructs a dense 2D grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>vec2i</em>) – Resolution of the grid along each dimension</p></li>
<li><p><strong>bounds_lo</strong> (<em>vec2f</em>) – Position of the lower bound of the axis-aligned grid</p></li>
<li><p><strong>bounds_up</strong> – Position of the upper bound of the axis-aligned grid</p></li>
<li><p><strong>bounds_hi</strong> (<em>vec2f</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Trimesh2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Trimesh2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tri_vertex_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Trimesh2D" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
<p>Two-dimensional triangular mesh geometry</p>
<p>Constructs a two-dimensional triangular mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tri_vertex_indices</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_tris, 3) containing vertex indices for each tri</p></li>
<li><p><strong>positions</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_vertices, 2) containing 2d position for each vertex</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – shared pool from which to allocate temporary arrays</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Quadmesh2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Quadmesh2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad_vertex_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Quadmesh2D" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
<p>Two-dimensional quadrilateral mesh geometry</p>
<p>Constructs a two-dimensional quadrilateral mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quad_vertex_indices</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_tris, 4) containing vertex indices for each quad, in counter-clockwise order</p></li>
<li><p><strong>positions</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_vertices, 2) containing 2d position for each vertex</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – shared pool from which to allocate temporary arrays</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Grid3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Grid3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_lo=&lt;warp.types.vec3f</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_hi=&lt;warp.types.vec3f</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Grid3D" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
<p>Three-dimensional regular grid geometry</p>
<p>Constructs a dense 3D grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>vec3i</em>) – Resolution of the grid along each dimension</p></li>
<li><p><strong>bounds_lo</strong> (<em>vec3f</em>) – Position of the lower bound of the axis-aligned grid</p></li>
<li><p><strong>bounds_up</strong> – Position of the upper bound of the axis-aligned grid</p></li>
<li><p><strong>bounds_hi</strong> (<em>vec3f</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Tetmesh">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Tetmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tet_vertex_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Tetmesh" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
<p>Tetrahedral mesh geometry</p>
<p>Constructs a tetrahedral mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tet_vertex_indices</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_tets, 4) containing vertex indices for each tet</p></li>
<li><p><strong>positions</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_vertices, 3) containing 3d position for each vertex</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – shared pool from which to allocate temporary arrays</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Hexmesh">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Hexmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hex_vertex_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Hexmesh" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
<p>Hexahedral mesh geometry</p>
<p>Constructs a tetrahedral mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hex_vertex_indices</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_hexes, 8) containing vertex indices for each hex
following standard ordering (bottom face vertices in counter-clockwise order, then similarly for upper face)</p></li>
<li><p><strong>positions</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – warp array of shape (num_vertices, 3) containing 3d position for each vertex</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – shared pool from which to allocate temporary arrays</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.LinearGeometryPartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">LinearGeometryPartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.LinearGeometryPartition" title="Link to this definition">#</a></dt>
<dd><p>Creates a geometry partition by uniformly partionning cell indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a>) – the geometry to partition</p></li>
<li><p><strong>partition_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the index of the partition being created</p></li>
<li><p><strong>partition_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the number of partitions that will be created over the geometry</p></li>
<li><p><strong>device</strong> – Warp device on which to perform and store computations</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.ExplicitGeometryPartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">ExplicitGeometryPartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.ExplicitGeometryPartition" title="Link to this definition">#</a></dt>
<dd><p>Creates a geometry partition by uniformly partionning cell indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a>) – the geometry to partition</p></li>
<li><p><strong>cell_mask</strong> (<em>wp.array</em><em>(</em><em>dtype=int</em><em>)</em>) – warp array of length <code class="docutils literal notranslate"><span class="pre">geometry.cell_count()</span></code> indicating which cells are selected. Array values must be either <code class="docutils literal notranslate"><span class="pre">1</span></code> (selected) or <code class="docutils literal notranslate"><span class="pre">0</span></code> (not selected).</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Cells">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Cells" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometryDomain</span></code></a></p>
<p>A Domain containing all cells of the geometry or geometry partition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a><em> | </em><a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.geometry.partition.GeometryPartition"><em>GeometryPartition</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Sides">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Sides</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Sides" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometryDomain</span></code></a></p>
<p>A Domain containing all (interior and boundary) sides of the geometry or geometry partition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a><em> | </em><a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.geometry.partition.GeometryPartition"><em>GeometryPartition</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.BoundarySides">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">BoundarySides</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.BoundarySides" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Sides" title="warp.fem.domain.Sides"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sides</span></code></a></p>
<p>A Domain containing boundary sides of the geometry or geometry partition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a><em> | </em><a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.geometry.partition.GeometryPartition"><em>GeometryPartition</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.FrontierSides">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">FrontierSides</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.FrontierSides" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Sides" title="warp.fem.domain.Sides"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sides</span></code></a></p>
<p>A Domain containing frontier sides of the geometry partition (sides shared with at least another partition)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a><em> | </em><a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.geometry.partition.GeometryPartition"><em>GeometryPartition</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Polynomial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Polynomial" title="Link to this definition">#</a></dt>
<dd><p>Polynomial family defining interpolation nodes over an interval</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.Polynomial.GAUSS_LEGENDRE">
<span class="sig-name descname"><span class="pre">GAUSS_LEGENDRE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#warp.fem.Polynomial.GAUSS_LEGENDRE" title="Link to this definition">#</a></dt>
<dd><p>Gauss–Legendre 1D polynomial family (does not include endpoints)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.Polynomial.LOBATTO_GAUSS_LEGENDRE">
<span class="sig-name descname"><span class="pre">LOBATTO_GAUSS_LEGENDRE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#warp.fem.Polynomial.LOBATTO_GAUSS_LEGENDRE" title="Link to this definition">#</a></dt>
<dd><p>Lobatto–Gauss–Legendre 1D polynomial family (includes endpoints)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.Polynomial.EQUISPACED_CLOSED">
<span class="sig-name descname"><span class="pre">EQUISPACED_CLOSED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#warp.fem.Polynomial.EQUISPACED_CLOSED" title="Link to this definition">#</a></dt>
<dd><p>Closed 1D polynomial family with uniformly distributed nodes (includes endpoints)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.Polynomial.EQUISPACED_OPEN">
<span class="sig-name descname"><span class="pre">EQUISPACED_OPEN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#warp.fem.Polynomial.EQUISPACED_OPEN" title="Link to this definition">#</a></dt>
<dd><p>Open 1D polynomial family with uniformly distributed nodes (does not include endpoints)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.RegularQuadrature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">RegularQuadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.RegularQuadrature" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.quadrature.quadrature.Quadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quadrature</span></code></a></p>
<p>Regular quadrature formula, using a constant set of quadrature points per element</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a>) – </p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – </p></li>
<li><p><strong>family</strong> (<a class="reference internal" href="#warp.fem.Polynomial" title="warp.fem.polynomial.Polynomial"><em>Polynomial</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.NodalQuadrature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">NodalQuadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.NodalQuadrature" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.quadrature.quadrature.Quadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quadrature</span></code></a></p>
<p>Quadrature using space node points as quadrature points</p>
<p>Note that in contrast to the <cite>nodal=True</cite> flag for <a class="reference internal" href="#warp.fem.integrate" title="warp.fem.integrate"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate()</span></code></a>, this quadrature odes not make any assumption
about orthogonality of shape functions, and is thus safe to use for arbitrary integrands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a>) – </p></li>
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.ExplicitQuadrature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">ExplicitQuadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.ExplicitQuadrature" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.quadrature.quadrature.Quadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quadrature</span></code></a></p>
<p>Quadrature using explicit per-cell points and weights. The number of quadrature points per cell is assumed
to be constant and deduced from the shape of the points and weights arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a>) – Domain of definition of the quadrature formula</p></li>
<li><p><strong>points</strong> (<em>wp.array2d</em><em>(</em><em>dtype=Coords</em><em>)</em>) – 2d array of shape <code class="docutils literal notranslate"><span class="pre">(domain.geometry_element-count(),</span> <span class="pre">points_per_cell)</span></code> containing the coordinates of each quadrature point.</p></li>
<li><p><strong>weights</strong> (<em>wp.array2d</em><em>(</em><em>dtype=float</em><em>)</em>) – 2d array of shape <code class="docutils literal notranslate"><span class="pre">(domain.geometry_element-count(),</span> <span class="pre">points_per_cell)</span></code> containing the weight for each quadrature point.</p></li>
</ul>
</dd>
</dl>
<p>See also: <a class="reference internal" href="#warp.fem.PicQuadrature" title="warp.fem.PicQuadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">PicQuadrature</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.PicQuadrature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">PicQuadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.PicQuadrature" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.quadrature.quadrature.Quadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quadrature</span></code></a></p>
<p>Particle-based quadrature formula, using a global set of points unevenly spread out over geometry elements.</p>
<p>Useful for Particle-In-Cell and derived methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a>) – Underlying domain for the quadrature</p></li>
<li><p><strong>positions</strong> (<em>wp.array</em><em>(</em><em>dtype=wp.vecXd</em><em>) </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><em>Tuple</em></a><em>[</em><em>wp.array</em><em>(</em><em>dtype=ElementIndex</em><em>)</em><em>, </em><em>wp.array</em><em>(</em><em>dtype=Coords</em><em>)</em><em>]</em>) – Either an array containing the world positions of all particles, or a tuple of arrays containing
the cell indices and coordinates for each particle. Note that the former requires the underlying geometry to
define a global <code class="xref py py-meth docutils literal notranslate"><span class="pre">Geometry.cell_lookup()</span></code> method; currently this is only available for <a class="reference internal" href="#warp.fem.Grid2D" title="warp.fem.Grid2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid2D</span></code></a> and <a class="reference internal" href="#warp.fem.Grid3D" title="warp.fem.Grid3D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grid3D</span></code></a>.</p></li>
<li><p><strong>measures</strong> (<em>wp.array</em><em>(</em><em>dtype=float</em><em>) </em><em>| </em><em>None</em>) – Array containing the measure (area/volume) of each particle, used to defined the integration weights.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the cell measure divided by the number of particles in the cell.</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a>) – shared pool from which to allocate temporary arrays</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="function-spaces">
<h2>Function Spaces<a class="headerlink" href="#function-spaces" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_polynomial_space">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_polynomial_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_mapper=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_basis=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discontinuous=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_polynomial_space" title="Link to this definition">#</a></dt>
<dd><p>Equips a geometry with a collocated, polynomial function space.
Equivalent to successive calls to <a class="reference internal" href="#warp.fem.make_polynomial_basis_space" title="warp.fem.make_polynomial_basis_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_polynomial_basis_space()</span></code></a> and <cite>make_collocated_function_space</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a>) – the Geometry on which to build the space</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><em>type</em></a>) – value type the function space. If <code class="docutils literal notranslate"><span class="pre">dof_mapper</span></code> is provided, the value type from the DofMapper will be used instead.</p></li>
<li><p><strong>dof_mapper</strong> (<a class="reference internal" href="#warp.fem.DofMapper" title="warp.fem.space.dof_mapper.DofMapper"><em>DofMapper</em></a><em> | </em><em>None</em>) – mapping from node degrees of freedom to function values, defaults to Identity. Useful for reduced coordinates, e.g. <a class="reference internal" href="#warp.fem.SymmetricTensorMapper" title="warp.fem.SymmetricTensorMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricTensorMapper</span></code></a> maps 2x2 (resp 3x3) symmetric tensors to 3 (resp 6) degrees of freedom.</p></li>
<li><p><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – polynomial degree of the per-element shape functions</p></li>
<li><p><strong>discontinuous</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – if True, use Discontinuous Galerkin shape functions. Discontinuous is implied if degree is 0, i.e, piecewise-constant shape functions.</p></li>
<li><p><strong>element_basis</strong> (<a class="reference internal" href="#warp.fem.ElementBasis" title="warp.fem.space.ElementBasis"><em>ElementBasis</em></a><em> | </em><em>None</em>) – type of basis function for the individual elements</p></li>
<li><p><strong>family</strong> (<a class="reference internal" href="#warp.fem.Polynomial" title="warp.fem.polynomial.Polynomial"><em>Polynomial</em></a><em> | </em><em>None</em>) – Polynomial family used to generate the shape function basis. If not provided, a reasonable basis is chosen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the constructed function space</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>CollocatedFunctionSpace</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_polynomial_basis_space">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_polynomial_basis_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discontinuous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_polynomial_basis_space" title="Link to this definition">#</a></dt>
<dd><p>Equips a geometry with a polynomial basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a>) – the Geometry on which to build the space</p></li>
<li><p><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – polynomial degree of the per-element shape functions</p></li>
<li><p><strong>discontinuous</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – if True, use Discontinuous Galerkin shape functions. Discontinuous is implied if degree is 0, i.e, piecewise-constant shape functions.</p></li>
<li><p><strong>element_basis</strong> (<a class="reference internal" href="#warp.fem.ElementBasis" title="warp.fem.space.ElementBasis"><em>ElementBasis</em></a><em> | </em><em>None</em>) – type of basis function for the individual elements</p></li>
<li><p><strong>family</strong> (<a class="reference internal" href="#warp.fem.Polynomial" title="warp.fem.polynomial.Polynomial"><em>Polynomial</em></a><em> | </em><em>None</em>) – Polynomial family used to generate the shape function basis. If not provided, a reasonable basis is chosen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the constructed basis space</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.BasisSpace" title="warp.fem.space.basis_space.BasisSpace"><em>BasisSpace</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_collocated_function_space">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_collocated_function_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_mapper=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_collocated_function_space" title="Link to this definition">#</a></dt>
<dd><p>Constructs a function space from a basis space and a value type, such that all degrees of freedom of the value type are stored at each of the basis nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo</strong> – the Geometry on which to build the space</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><em>type</em></a>) – value type the function space. If <code class="docutils literal notranslate"><span class="pre">dof_mapper</span></code> is provided, the value type from the DofMapper will be used instead.</p></li>
<li><p><strong>dof_mapper</strong> (<a class="reference internal" href="#warp.fem.DofMapper" title="warp.fem.space.dof_mapper.DofMapper"><em>DofMapper</em></a><em> | </em><em>None</em>) – mapping from node degrees of freedom to function values, defaults to Identity. Useful for reduced coordinates, e.g. <a class="reference internal" href="#warp.fem.SymmetricTensorMapper" title="warp.fem.SymmetricTensorMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricTensorMapper</span></code></a> maps 2x2 (resp 3x3) symmetric tensors to 3 (resp 6) degrees of freedom.</p></li>
<li><p><strong>basis_space</strong> (<a class="reference internal" href="#warp.fem.BasisSpace" title="warp.fem.space.basis_space.BasisSpace"><em>BasisSpace</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the constructed function space</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>CollocatedFunctionSpace</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_space_partition">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_space_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry_partition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_topology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_halo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_space_partition" title="Link to this definition">#</a></dt>
<dd><p>Computes the subset of nodes from a function space topology that touch a geometry partition</p>
<p>Either <cite>space_topology</cite> or <cite>space</cite> must be provided (and will be considered in that order).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a><em> | </em><em>None</em>) – (deprecated) the function space defining the topology if <cite>space_topology</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>geometry_partition</strong> (<a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.geometry.partition.GeometryPartition"><em>GeometryPartition</em></a><em> | </em><em>None</em>) – The subset of the space geometry.  If not provided, use the whole geometry.</p></li>
<li><p><strong>space_topology</strong> (<a class="reference internal" href="#warp.fem.SpaceTopology" title="warp.fem.space.topology.SpaceTopology"><em>SpaceTopology</em></a><em> | </em><em>None</em>) – the topology of the function space to consider. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, deduced from <cite>space</cite>.</p></li>
<li><p><strong>with_halo</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – if True, include the halo nodes (nodes from exterior frontier cells to the partition)</p></li>
<li><p><strong>device</strong> – Warp device on which to perform and store computations</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the resulting space partition</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_space_restriction">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_space_restriction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_partition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_topology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_space_restriction" title="Link to this definition">#</a></dt>
<dd><p>Restricts a function space partition to a Domain, i.e. a subset of its elements.</p>
<p>One of <cite>space_partition</cite>, <cite>space_topology</cite>, or <cite>space</cite> must be provided (and will be considered in that order).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a><em> | </em><em>None</em>) – (deprecated) if neither <cite>space_partition</cite> nor <cite>space_topology</cite> are provided, the space defining the topology to restrict</p></li>
<li><p><strong>space_partition</strong> (<a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a><em> | </em><em>None</em>) – the subset of nodes from the space topology to consider</p></li>
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a><em> | </em><em>None</em>) – the domain to restrict the space to, defaults to all cells of the space geometry or partition.</p></li>
<li><p><strong>space_topology</strong> (<a class="reference internal" href="#warp.fem.SpaceTopology" title="warp.fem.space.topology.SpaceTopology"><em>SpaceTopology</em></a><em> | </em><em>None</em>) – the space topology to be restricted, if <cite>space_partition</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>device</strong> – device on which to perform and store computations</p></li>
<li><p><strong>temporary_store</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>warp.fem.cache.TemporaryStore</em></a><em>]</em>) – shared pool from which to allocate temporary arrays</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.fem.SpaceRestriction" title="warp.fem.space.restriction.SpaceRestriction"><em>SpaceRestriction</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.ElementBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">ElementBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.ElementBasis" title="Link to this definition">#</a></dt>
<dd><p>Choice of basis function to equip individual elements</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.ElementBasis.LAGRANGE">
<span class="sig-name descname"><span class="pre">LAGRANGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#warp.fem.ElementBasis.LAGRANGE" title="Link to this definition">#</a></dt>
<dd><p>Lagrange basis functions <span class="math notranslate nohighlight">\(P_k\)</span> for simplices, tensor products <span class="math notranslate nohighlight">\(Q_k\)</span> for squares and cubes</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.ElementBasis.SERENDIPITY">
<span class="sig-name descname"><span class="pre">SERENDIPITY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#warp.fem.ElementBasis.SERENDIPITY" title="Link to this definition">#</a></dt>
<dd><p>Serendipity elements <span class="math notranslate nohighlight">\(S_k\)</span>, corresponding to Lagrange nodes with interior points removed (for degree &lt;= 3)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.ElementBasis.NONCONFORMING_POLYNOMIAL">
<span class="sig-name descname"><span class="pre">NONCONFORMING_POLYNOMIAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#warp.fem.ElementBasis.NONCONFORMING_POLYNOMIAL" title="Link to this definition">#</a></dt>
<dd><p>Simplex Lagrange basis functions <span class="math notranslate nohighlight">\(P_{kd}\)</span> embedded into non conforming reference elements (e.g. squares or cubes). Discontinuous only.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.SymmetricTensorMapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">SymmetricTensorMapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Mapping.VOIGT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SymmetricTensorMapper" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.DofMapper" title="warp.fem.space.dof_mapper.DofMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">DofMapper</span></code></a></p>
<p>Orthonormal isomorphism from R^{n (n+1)} to nxn symmetric tensors,
using usual L2 norm for vectors and half Frobenius norm, (tau : tau)/2 for tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><em>type</em></a>) – </p></li>
<li><p><strong>mapping</strong> (<em>Mapping</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.SkewSymmetricTensorMapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">SkewSymmetricTensorMapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SkewSymmetricTensorMapper" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.DofMapper" title="warp.fem.space.dof_mapper.DofMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">DofMapper</span></code></a></p>
<p>Orthonormal isomorphism from R^{n (n-1)} to nxn skew-symmetric tensors,
using usual L2 norm for vectors and half Frobenius norm, (tau : tau)/2 for tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><em>type</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.PointBasisSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">PointBasisSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quadrature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.PointBasisSpace" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.BasisSpace" title="warp.fem.space.basis_space.BasisSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasisSpace</span></code></a></p>
<p>An unstructured <a class="reference internal" href="#warp.fem.BasisSpace" title="warp.fem.BasisSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasisSpace</span></code></a> that is non-zero at a finite set of points only.</p>
<p>The node locations and nodal quadrature weights are defined by a <a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.Quadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quadrature</span></code></a> formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quadrature</strong> (<a class="reference internal" href="#warp.fem.Quadrature" title="warp.fem.quadrature.quadrature.Quadrature"><em>Quadrature</em></a>) – </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="fields">
<h2>Fields<a class="headerlink" href="#fields" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_test">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_restriction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_partition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_test" title="Link to this definition">#</a></dt>
<dd><p>Constructs a test field over a function space or its restriction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a>) – the function space</p></li>
<li><p><strong>space_restriction</strong> (<a class="reference internal" href="#warp.fem.SpaceRestriction" title="warp.fem.space.restriction.SpaceRestriction"><em>SpaceRestriction</em></a><em> | </em><em>None</em>) – restriction of the space topology to a domain</p></li>
<li><p><strong>space_partition</strong> (<a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a><em> | </em><em>None</em>) – if <cite>space_restriction</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the optional subset of node indices to consider</p></li>
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a><em> | </em><em>None</em>) – if <cite>space_restriction</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional subset of elements to consider</p></li>
<li><p><strong>device</strong> – Warp device on which to perform and store computations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the test field</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.field.TestField" title="warp.fem.field.test.TestField"><em>TestField</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_trial">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_trial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_restriction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_partition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_trial" title="Link to this definition">#</a></dt>
<dd><p>Constructs a trial field over a function space or partition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a>) – the function space or function space restriction</p></li>
<li><p><strong>space_restriction</strong> (<a class="reference internal" href="#warp.fem.SpaceRestriction" title="warp.fem.space.restriction.SpaceRestriction"><em>SpaceRestriction</em></a><em> | </em><em>None</em>) – restriction of the space topology to a domain</p></li>
<li><p><strong>space_partition</strong> (<a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a><em> | </em><em>None</em>) – if <cite>space_restriction</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the optional subset of node indices to consider</p></li>
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a><em> | </em><em>None</em>) – if <cite>space_restriction</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional subset of elements to consider</p></li>
<li><p><strong>device</strong> – Warp device on which to perform and store computations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the trial field</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.field.TrialField" title="warp.fem.field.trial.TrialField"><em>TrialField</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.make_restriction">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">make_restriction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_restriction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.make_restriction" title="Link to this definition">#</a></dt>
<dd><p>Restricts a discrete field to a subset of elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<a class="reference internal" href="#warp.fem.DiscreteField" title="warp.fem.field.field.DiscreteField"><em>DiscreteField</em></a>) – the discrete field to restrict</p></li>
<li><p><strong>space_restriction</strong> (<a class="reference internal" href="#warp.fem.SpaceRestriction" title="warp.fem.space.restriction.SpaceRestriction"><em>SpaceRestriction</em></a><em> | </em><em>None</em>) – the function space restriction defining the subset of elements to consider</p></li>
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a><em> | </em><em>None</em>) – if <code class="docutils literal notranslate"><span class="pre">space_restriction</span></code> is not provided, the <a class="reference internal" href="#warp.fem.Domain" title="warp.fem.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Domain</span></code></a> defining the subset of elements to consider</p></li>
<li><p><strong>device</strong> – Warp device on which to perform and store computations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the field restriction</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.field.FieldRestriction" title="warp.fem.field.restriction.FieldRestriction"><em>FieldRestriction</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="boundary-conditions">
<h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.normalize_dirichlet_projector">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">normalize_dirichlet_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projector_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.normalize_dirichlet_projector" title="Link to this definition">#</a></dt>
<dd><p>Scale projector so that it becomes idempotent, and apply the same scaling to fixed_value if provided</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projector_matrix</strong> (<a class="reference internal" href="sparse.html#warp.sparse.BsrMatrix" title="warp.sparse.BsrMatrix"><em>BsrMatrix</em></a>) – </p></li>
<li><p><strong>fixed_value</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.project_linear_system">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">project_linear_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_rhs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projector_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_projector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.project_linear_system" title="Link to this definition">#</a></dt>
<dd><p>Projects both the left-hand-side and right-hand-side of a linear system to enforce Dirichlet boundary conditions</p>
<p>If normalize_projector is True, first apply scaling so that the projector_matrix is idempotent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system_matrix</strong> (<a class="reference internal" href="sparse.html#warp.sparse.BsrMatrix" title="warp.sparse.BsrMatrix"><em>BsrMatrix</em></a>) – </p></li>
<li><p><strong>system_rhs</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – </p></li>
<li><p><strong>projector_matrix</strong> (<a class="reference internal" href="sparse.html#warp.sparse.BsrMatrix" title="warp.sparse.BsrMatrix"><em>BsrMatrix</em></a>) – </p></li>
<li><p><strong>fixed_value</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id2">
<h2>Memory management<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.set_default_temporary_store">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">set_default_temporary_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.set_default_temporary_store" title="Link to this definition">#</a></dt>
<dd><p>Globally sets the default <a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.TemporaryStore"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemporaryStore</span></code></a> instance to use for temporary allocations in <code class="docutils literal notranslate"><span class="pre">warp.fem</span></code> functions.</p>
<p>If the default temporary store is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, temporary allocations are not persisted unless a <a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.TemporaryStore"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemporaryStore</span></code></a> is provided at a per-function granularity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.borrow_temporary">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">borrow_temporary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.borrow_temporary" title="Link to this definition">#</a></dt>
<dd><p>Borrows and returns a temporary array with specified attributes from a shared pool.</p>
<p>If an array with sufficient capacity and matching desired attributes is already available in the pool, it will be returned.
Otherwise, a new allocation will be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – the shared pool to borrow the temporary from. If <cite>temporary_store</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the global default temporary store, if set, will be used.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><em>Tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – desired dimensions for the temporary array</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><em>type</em></a>) – desired data type for the temporary array</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – whether a pinned allocation is desired</p></li>
<li><p><strong>device</strong> – device on which the memory should be allocated; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the current device will be used.</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.fem.cache.Temporary" title="warp.fem.cache.Temporary"><em>Temporary</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.fem.borrow_temporary_like">
<span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">borrow_temporary_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.borrow_temporary_like" title="Link to this definition">#</a></dt>
<dd><p>Borrows and returns a temporary array with the same attributes as another array or temporary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><a class="reference internal" href="#warp.fem.cache.Temporary" title="warp.fem.cache.Temporary"><em>Temporary</em></a>) – Warp or temporary array to read the desired attributes from</p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a><em> | </em><em>None</em>) – the shared pool to borrow the temporary from. If <cite>temporary_store</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the global default temporary store, if set, will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.fem.cache.Temporary" title="warp.fem.cache.Temporary"><em>Temporary</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="interfaces">
<h2>Interfaces<a class="headerlink" href="#interfaces" title="Link to this heading">#</a></h2>
<p>Interface classes are not meant to be constructed directly, but can be derived from extend the built-in functionality.</p>
<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Geometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Geometry</span></span><a class="headerlink" href="#warp.fem.Geometry" title="Link to this definition">#</a></dt>
<dd><p>Interface class for discrete geometries</p>
<p>A geometry is composed of cells and sides. Sides may be boundary or interior (between cells).</p>
<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.Geometry.cell_count">
<span class="sig-name descname"><span class="pre">cell_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Geometry.cell_count" title="Link to this definition">#</a></dt>
<dd><p>Number of cells in the geometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.Geometry.side_count">
<span class="sig-name descname"><span class="pre">side_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Geometry.side_count" title="Link to this definition">#</a></dt>
<dd><p>Number of sides in the geometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.Geometry.boundary_side_count">
<span class="sig-name descname"><span class="pre">boundary_side_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Geometry.boundary_side_count" title="Link to this definition">#</a></dt>
<dd><p>Number of boundary sides (sides with a single neighbour cell) in the geometry</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.GeometryPartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">GeometryPartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryPartition" title="Link to this definition">#</a></dt>
<dd><p>Base class for geometry partitions, i.e. subset of cells and sides</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.GeometryPartition.cell_count">
<span class="sig-name descname"><span class="pre">cell_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryPartition.cell_count" title="Link to this definition">#</a></dt>
<dd><p>Number of cells that are ‘owned’ by this partition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.GeometryPartition.side_count">
<span class="sig-name descname"><span class="pre">side_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryPartition.side_count" title="Link to this definition">#</a></dt>
<dd><p>Number of sides that are ‘owned’ by this partition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.GeometryPartition.boundary_side_count">
<span class="sig-name descname"><span class="pre">boundary_side_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryPartition.boundary_side_count" title="Link to this definition">#</a></dt>
<dd><p>Number of geo-boundary sides that are ‘owned’ by this partition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.GeometryPartition.frontier_side_count">
<span class="sig-name descname"><span class="pre">frontier_side_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryPartition.frontier_side_count" title="Link to this definition">#</a></dt>
<dd><p>Number of sides with neighbors owned by this and another partition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.GeometryDomain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">GeometryDomain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryDomain" title="Link to this definition">#</a></dt>
<dd><p>Interface class for domains, i.e. (partial) views of elements in a Geometry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a><em> | </em><a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.geometry.partition.GeometryPartition"><em>GeometryPartition</em></a>) – </p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.GeometryDomain.ElementKind">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ElementKind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryDomain.ElementKind" title="Link to this definition">#</a></dt>
<dd><p>Possible kinds of elements contained in a domain</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.GeometryDomain.element_kind">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">element_kind</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#warp.fem.GeometryDomain.ElementKind" title="warp.fem.domain.GeometryDomain.ElementKind"><span class="pre">ElementKind</span></a></em><a class="headerlink" href="#warp.fem.GeometryDomain.element_kind" title="Link to this definition">#</a></dt>
<dd><p>Kind of elements that this domain contains (cells or sides)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.GeometryDomain.dimension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dimension</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.fem.GeometryDomain.dimension" title="Link to this definition">#</a></dt>
<dd><p>Dimension of the elements of the domain</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.GeometryDomain.element_count">
<span class="sig-name descname"><span class="pre">element_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.GeometryDomain.element_count" title="Link to this definition">#</a></dt>
<dd><p>Number of elements in the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.Quadrature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">Quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Quadrature" title="Link to this definition">#</a></dt>
<dd><p>Interface class for quadrature rules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a>) – </p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.Quadrature.domain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">domain</span></span><a class="headerlink" href="#warp.fem.Quadrature.domain" title="Link to this definition">#</a></dt>
<dd><p>Domain over which this quadrature is defined</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.Quadrature.total_point_count">
<span class="sig-name descname"><span class="pre">total_point_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.Quadrature.total_point_count" title="Link to this definition">#</a></dt>
<dd><p>Total number of quadrature points over the domain</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">FunctionSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.FunctionSpace" title="Link to this definition">#</a></dt>
<dd><p>Interface class for function spaces, i.e. geometry + interpolation basis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topology</strong> (<a class="reference internal" href="#warp.fem.SpaceTopology" title="warp.fem.space.topology.SpaceTopology"><em>SpaceTopology</em></a>) – </p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><span class="pre">type</span></a></em><a class="headerlink" href="#warp.fem.FunctionSpace.dtype" title="Link to this definition">#</a></dt>
<dd><p>Value type of the interpolation functions</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace.topology">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">topology</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#warp.fem.SpaceTopology" title="warp.fem.space.topology.SpaceTopology"><span class="pre">SpaceTopology</span></a></em><a class="headerlink" href="#warp.fem.FunctionSpace.topology" title="Link to this definition">#</a></dt>
<dd><p>Underlying geometry</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace.geometry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geometry</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><span class="pre">Geometry</span></a></em><a class="headerlink" href="#warp.fem.FunctionSpace.geometry" title="Link to this definition">#</a></dt>
<dd><p>Underlying geometry</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace.dimension">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dimension</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.fem.FunctionSpace.dimension" title="Link to this definition">#</a></dt>
<dd><p>Function space embedding dimension</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace.degree">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.fem.FunctionSpace.degree" title="Link to this definition">#</a></dt>
<dd><p>Maximum polynomial degree of the underlying basis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.FunctionSpace.trace" title="Link to this definition">#</a></dt>
<dd><p>Trace of the function space over lower-dimensional elements of the geometry</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.FunctionSpace.make_field">
<span class="sig-name descname"><span class="pre">make_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space_partition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.FunctionSpace.make_field" title="Link to this definition">#</a></dt>
<dd><p>Creates a zero-initialized discrete field over the function space holding values for all degrees of freedom of nodes in a space partition</p>
<dl class="simple">
<dt>space_arg:</dt><dd><p>space_partition: If provided, the subset of nodes to consider</p>
</dd>
</dl>
<p>See also: <a class="reference internal" href="#warp.fem.make_space_partition" title="warp.fem.make_space_partition"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_space_partition()</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.SpaceTopology">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">SpaceTopology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes_per_element</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpaceTopology" title="Link to this definition">#</a></dt>
<dd><p>Interface class for defining the topology of a function space.</p>
<p>The topology only considers the indices of the nodes in each element, and as such,
the connectivity pattern of the function space.
It does not specify the actual location of the nodes within the elements, or the valuation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a>) – </p></li>
<li><p><strong>nodes_per_element</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.fem.SpaceTopology.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.fem.SpaceTopology.dimension" title="Link to this definition">#</a></dt>
<dd><p>Embedding dimension of the function space</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.SpaceTopology.geometry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geometry</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><span class="pre">Geometry</span></a></em><a class="headerlink" href="#warp.fem.SpaceTopology.geometry" title="Link to this definition">#</a></dt>
<dd><p>Underlying geometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.SpaceTopology.node_count">
<span class="sig-name descname"><span class="pre">node_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpaceTopology.node_count" title="Link to this definition">#</a></dt>
<dd><p>Number of nodes in the interpolation basis</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.SpaceTopology.element_node_indices">
<span class="sig-name descname"><span class="pre">element_node_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpaceTopology.element_node_indices" title="Link to this definition">#</a></dt>
<dd><p>Returns a temporary array containing the global index for each node of each element</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.SpaceTopology.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpaceTopology.trace" title="Link to this definition">#</a></dt>
<dd><p>Trace of the function space over lower-dimensional elements of the geometry</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>TraceSpaceTopology</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.BasisSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">BasisSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.BasisSpace" title="Link to this definition">#</a></dt>
<dd><p>Interface class for defining a scalar-valued basis over a geometry.</p>
<p>A basis space makes it easy to define multiple function spaces sharing the same basis (and thus nodes) but with different valuation functions;
however, it is not a required ingredient of a function space.</p>
<p>See also: <a class="reference internal" href="#warp.fem.make_polynomial_basis_space" title="warp.fem.make_polynomial_basis_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_polynomial_basis_space()</span></code></a>, <a class="reference internal" href="#warp.fem.make_collocated_function_space" title="warp.fem.make_collocated_function_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_collocated_function_space()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topology</strong> (<a class="reference internal" href="#warp.fem.SpaceTopology" title="warp.fem.space.topology.SpaceTopology"><em>SpaceTopology</em></a>) – </p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.BasisSpace.topology">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">topology</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#warp.fem.SpaceTopology" title="warp.fem.space.topology.SpaceTopology"><span class="pre">SpaceTopology</span></a></em><a class="headerlink" href="#warp.fem.BasisSpace.topology" title="Link to this definition">#</a></dt>
<dd><p>Underlying topology of the basis space</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.BasisSpace.geometry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geometry</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><span class="pre">Geometry</span></a></em><a class="headerlink" href="#warp.fem.BasisSpace.geometry" title="Link to this definition">#</a></dt>
<dd><p>Underlying geometry of the basis space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.BasisSpace.node_positions">
<span class="sig-name descname"><span class="pre">node_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.BasisSpace.node_positions" title="Link to this definition">#</a></dt>
<dd><p>Returns a temporary array containing the world position for each node</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.space.shape.ShapeFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.space.shape.</span></span><span class="sig-name descname"><span class="pre">ShapeFunction</span></span><a class="headerlink" href="#warp.fem.space.shape.ShapeFunction" title="Link to this definition">#</a></dt>
<dd><p>Interface class for defining scalar-valued shape functions over a single element</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.SpacePartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">SpacePartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space_topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo_partition</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpacePartition" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space_topology</strong> (<a class="reference internal" href="#warp.fem.SpaceTopology" title="warp.fem.space.topology.SpaceTopology"><em>SpaceTopology</em></a>) – </p></li>
<li><p><strong>geo_partition</strong> (<a class="reference internal" href="#warp.fem.GeometryPartition" title="warp.fem.geometry.partition.GeometryPartition"><em>GeometryPartition</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.SpacePartition.node_count">
<span class="sig-name descname"><span class="pre">node_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpacePartition.node_count" title="Link to this definition">#</a></dt>
<dd><p>Returns number of nodes in this partition</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.SpacePartition.owned_node_count">
<span class="sig-name descname"><span class="pre">owned_node_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpacePartition.owned_node_count" title="Link to this definition">#</a></dt>
<dd><p>Returns number of nodes in this partition, excluding exterior halo</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.SpacePartition.interior_node_count">
<span class="sig-name descname"><span class="pre">interior_node_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpacePartition.interior_node_count" title="Link to this definition">#</a></dt>
<dd><p>Returns number of interior nodes in this partition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.SpacePartition.space_node_indices">
<span class="sig-name descname"><span class="pre">space_node_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpacePartition.space_node_indices" title="Link to this definition">#</a></dt>
<dd><p>Return the global function space indices for nodes in this partition</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.SpaceRestriction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">SpaceRestriction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.SpaceRestriction" title="Link to this definition">#</a></dt>
<dd><p>Restriction of a space partition to a given GeometryDomain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space_partition</strong> (<a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a>) – </p></li>
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a>) – </p></li>
<li><p><strong>temporary_store</strong> (<a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><em>TemporaryStore</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.DofMapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">DofMapper</span></span><a class="headerlink" href="#warp.fem.DofMapper" title="Link to this definition">#</a></dt>
<dd><p>Base class from mapping node degrees of freedom to function values</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.FieldLike">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">FieldLike</span></span><a class="headerlink" href="#warp.fem.FieldLike" title="Link to this definition">#</a></dt>
<dd><p>Base class for integrable fields</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.DiscreteField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">DiscreteField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_partition</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.DiscreteField" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.field.SpaceField" title="warp.fem.field.field.SpaceField"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceField</span></code></a></p>
<p>Explicitly-valued field defined over a partition of a discrete function space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a>) – </p></li>
<li><p><strong>space_partition</strong> (<a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.DiscreteField.dof_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dof_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><span class="pre">array</span></a></em><a class="headerlink" href="#warp.fem.DiscreteField.dof_values" title="Link to this definition">#</a></dt>
<dd><p>Array of degrees of freedom values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.DiscreteField.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.DiscreteField.trace" title="Link to this definition">#</a></dt>
<dd><p>Trace of this field over a lower-dimensional function space</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.DiscreteField" title="warp.fem.field.field.DiscreteField"><em>DiscreteField</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.DiscreteField.make_deformed_geometry">
<span class="sig-name descname"><span class="pre">make_deformed_geometry</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.DiscreteField.make_deformed_geometry" title="Link to this definition">#</a></dt>
<dd><p>Returns a deformed version of the underlying geometry using this field’s values as displacement</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.fem.Geometry" title="warp.fem.geometry.geometry.Geometry"><em>Geometry</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.field.FieldRestriction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.field.</span></span><span class="sig-name descname"><span class="pre">FieldRestriction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space_restriction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.field.FieldRestriction" title="Link to this definition">#</a></dt>
<dd><p>Restriction of a discrete field to a given GeometryDomain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space_restriction</strong> (<a class="reference internal" href="#warp.fem.SpaceRestriction" title="warp.fem.space.restriction.SpaceRestriction"><em>SpaceRestriction</em></a>) – </p></li>
<li><p><strong>field</strong> (<a class="reference internal" href="#warp.fem.DiscreteField" title="warp.fem.field.field.DiscreteField"><em>DiscreteField</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.field.SpaceField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.field.</span></span><span class="sig-name descname"><span class="pre">SpaceField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_partition</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.field.SpaceField" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.FieldLike" title="warp.fem.field.field.FieldLike"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldLike</span></code></a></p>
<p>Base class for fields defined over a function space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a>) – </p></li>
<li><p><strong>space_partition</strong> (<a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.field.TestField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.field.</span></span><span class="sig-name descname"><span class="pre">TestField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space_restriction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.field.TestField" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.field.SpaceField" title="warp.fem.field.field.SpaceField"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceField</span></code></a></p>
<p>Field defined over a space restriction that can be used as a test function.</p>
<p>In order to reuse computations, it is possible to define the test field using a SpaceRestriction
defined for a different value type than the test function value type, as long as the node topology is similar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space_restriction</strong> (<a class="reference internal" href="#warp.fem.SpaceRestriction" title="warp.fem.space.restriction.SpaceRestriction"><em>SpaceRestriction</em></a>) – </p></li>
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.field.TrialField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.field.</span></span><span class="sig-name descname"><span class="pre">TrialField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.field.TrialField" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#warp.fem.field.SpaceField" title="warp.fem.field.field.SpaceField"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceField</span></code></a></p>
<p>Field defined over a domain that can be used as a trial function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#warp.fem.FunctionSpace" title="warp.fem.space.function_space.FunctionSpace"><em>FunctionSpace</em></a>) – </p></li>
<li><p><strong>space_partition</strong> (<a class="reference internal" href="#warp.fem.SpacePartition" title="warp.fem.space.partition.SpacePartition"><em>SpacePartition</em></a>) – </p></li>
<li><p><strong>domain</strong> (<a class="reference internal" href="#warp.fem.GeometryDomain" title="warp.fem.domain.GeometryDomain"><em>GeometryDomain</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.TemporaryStore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.</span></span><span class="sig-name descname"><span class="pre">TemporaryStore</span></span><a class="headerlink" href="#warp.fem.TemporaryStore" title="Link to this definition">#</a></dt>
<dd><p>Shared pool of temporary arrays that will be persisted and reused across invocations of <code class="docutils literal notranslate"><span class="pre">warp.fem</span></code> functions.</p>
<p>A <a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.TemporaryStore"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemporaryStore</span></code></a> instance may either be passed explicitly to <code class="docutils literal notranslate"><span class="pre">warp.fem</span></code> functions that accept such an argument, for instance <code class="xref py py-func docutils literal notranslate"><span class="pre">integrate.integrate()</span></code>,
or can be set globally as the default store using <a class="reference internal" href="#warp.fem.set_default_temporary_store" title="warp.fem.set_default_temporary_store"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_default_temporary_store()</span></code></a>.</p>
<p>By default, there is no default temporary store, so that temporary allocations are not persisted.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.fem.cache.Temporary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.fem.cache.</span></span><span class="sig-name descname"><span class="pre">Temporary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.cache.Temporary" title="Link to this definition">#</a></dt>
<dd><p>Handle over a temporary array from a <a class="reference internal" href="#warp.fem.TemporaryStore" title="warp.fem.cache.TemporaryStore"><code class="xref py py-class docutils literal notranslate"><span class="pre">TemporaryStore</span></code></a>.</p>
<p>The array will be automatically returned to the temporary pool for reuse upon destruction of this object, unless
the temporary is explicitly detached from the pool using <a class="reference internal" href="#warp.fem.cache.Temporary.detach" title="warp.fem.cache.Temporary.detach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">detach()</span></code></a>.
The temporary may also be explicitly returned to the pool before destruction using <a class="reference internal" href="#warp.fem.cache.Temporary.release" title="warp.fem.cache.Temporary.release"><code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a>) – </p></li>
<li><p><strong>pool</strong> (<em>TemporaryStore.Pool</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.cache.Temporary.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.cache.Temporary.detach" title="Link to this definition">#</a></dt>
<dd><p>Detaches the temporary so it is never returned to the pool</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.fem.cache.Temporary.release">
<span class="sig-name descname"><span class="pre">release</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warp.fem.cache.Temporary.release" title="Link to this definition">#</a></dt>
<dd><p>Returns the temporary array to the pool</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.fem.cache.Temporary.array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="runtime.html#warp.array" title="warp.types.array"><span class="pre">array</span></a></em><a class="headerlink" href="#warp.fem.cache.Temporary.array" title="Link to this definition">#</a></dt>
<dd><p>View of the array with desired shape and data type.</p>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="render.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">warp.render</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="sparse.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">warp.sparse</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2024, NVIDIA
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/NVIDIA/warp" aria-label="GitHub">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
            </svg>
        </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">warp.fem</a><ul>
<li><a class="reference internal" href="#integrands">Integrands</a></li>
<li><a class="reference internal" href="#basic-workflow">Basic workflow</a></li>
<li><a class="reference internal" href="#introductory-examples">Introductory examples</a></li>
<li><a class="reference internal" href="#advanced-usages">Advanced usages</a><ul>
<li><a class="reference internal" href="#high-order-curved-geometries">High-order (curved) geometries</a></li>
<li><a class="reference internal" href="#particle-based-quadrature">Particle-based quadrature</a></li>
<li><a class="reference internal" href="#partitioning">Partitioning</a></li>
<li><a class="reference internal" href="#memory-management">Memory management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operators">Operators</a><ul>
<li><a class="reference internal" href="#warp.fem.position"><code class="docutils literal notranslate"><span class="pre">position()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.normal"><code class="docutils literal notranslate"><span class="pre">normal()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.lookup"><code class="docutils literal notranslate"><span class="pre">lookup()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.measure"><code class="docutils literal notranslate"><span class="pre">measure()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.measure_ratio"><code class="docutils literal notranslate"><span class="pre">measure_ratio()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.deformation_gradient"><code class="docutils literal notranslate"><span class="pre">deformation_gradient()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.degree"><code class="docutils literal notranslate"><span class="pre">degree()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.inner"><code class="docutils literal notranslate"><span class="pre">inner()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.outer"><code class="docutils literal notranslate"><span class="pre">outer()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.grad"><code class="docutils literal notranslate"><span class="pre">grad()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.grad_outer"><code class="docutils literal notranslate"><span class="pre">grad_outer()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.div"><code class="docutils literal notranslate"><span class="pre">div()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.div_outer"><code class="docutils literal notranslate"><span class="pre">div_outer()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.at_node"><code class="docutils literal notranslate"><span class="pre">at_node()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.D"><code class="docutils literal notranslate"><span class="pre">D()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.curl"><code class="docutils literal notranslate"><span class="pre">curl()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.jump"><code class="docutils literal notranslate"><span class="pre">jump()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.average"><code class="docutils literal notranslate"><span class="pre">average()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.grad_jump"><code class="docutils literal notranslate"><span class="pre">grad_jump()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.grad_average"><code class="docutils literal notranslate"><span class="pre">grad_average()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.operator.operator"><code class="docutils literal notranslate"><span class="pre">operator()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#integration">Integration</a><ul>
<li><a class="reference internal" href="#warp.fem.integrate"><code class="docutils literal notranslate"><span class="pre">integrate()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.interpolate"><code class="docutils literal notranslate"><span class="pre">interpolate()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.integrand"><code class="docutils literal notranslate"><span class="pre">integrand()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Sample"><code class="docutils literal notranslate"><span class="pre">Sample</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Field"><code class="docutils literal notranslate"><span class="pre">Field</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Domain"><code class="docutils literal notranslate"><span class="pre">Domain</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometry">Geometry</a><ul>
<li><a class="reference internal" href="#warp.fem.Grid2D"><code class="docutils literal notranslate"><span class="pre">Grid2D</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Trimesh2D"><code class="docutils literal notranslate"><span class="pre">Trimesh2D</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Quadmesh2D"><code class="docutils literal notranslate"><span class="pre">Quadmesh2D</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Grid3D"><code class="docutils literal notranslate"><span class="pre">Grid3D</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Tetmesh"><code class="docutils literal notranslate"><span class="pre">Tetmesh</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Hexmesh"><code class="docutils literal notranslate"><span class="pre">Hexmesh</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.LinearGeometryPartition"><code class="docutils literal notranslate"><span class="pre">LinearGeometryPartition</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.ExplicitGeometryPartition"><code class="docutils literal notranslate"><span class="pre">ExplicitGeometryPartition</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Cells"><code class="docutils literal notranslate"><span class="pre">Cells</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Sides"><code class="docutils literal notranslate"><span class="pre">Sides</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.BoundarySides"><code class="docutils literal notranslate"><span class="pre">BoundarySides</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FrontierSides"><code class="docutils literal notranslate"><span class="pre">FrontierSides</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Polynomial"><code class="docutils literal notranslate"><span class="pre">Polynomial</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.Polynomial.GAUSS_LEGENDRE"><code class="docutils literal notranslate"><span class="pre">Polynomial.GAUSS_LEGENDRE</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Polynomial.LOBATTO_GAUSS_LEGENDRE"><code class="docutils literal notranslate"><span class="pre">Polynomial.LOBATTO_GAUSS_LEGENDRE</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Polynomial.EQUISPACED_CLOSED"><code class="docutils literal notranslate"><span class="pre">Polynomial.EQUISPACED_CLOSED</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Polynomial.EQUISPACED_OPEN"><code class="docutils literal notranslate"><span class="pre">Polynomial.EQUISPACED_OPEN</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.RegularQuadrature"><code class="docutils literal notranslate"><span class="pre">RegularQuadrature</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.NodalQuadrature"><code class="docutils literal notranslate"><span class="pre">NodalQuadrature</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.ExplicitQuadrature"><code class="docutils literal notranslate"><span class="pre">ExplicitQuadrature</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.PicQuadrature"><code class="docutils literal notranslate"><span class="pre">PicQuadrature</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-spaces">Function Spaces</a><ul>
<li><a class="reference internal" href="#warp.fem.make_polynomial_space"><code class="docutils literal notranslate"><span class="pre">make_polynomial_space()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.make_polynomial_basis_space"><code class="docutils literal notranslate"><span class="pre">make_polynomial_basis_space()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.make_collocated_function_space"><code class="docutils literal notranslate"><span class="pre">make_collocated_function_space()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.make_space_partition"><code class="docutils literal notranslate"><span class="pre">make_space_partition()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.make_space_restriction"><code class="docutils literal notranslate"><span class="pre">make_space_restriction()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.ElementBasis"><code class="docutils literal notranslate"><span class="pre">ElementBasis</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.ElementBasis.LAGRANGE"><code class="docutils literal notranslate"><span class="pre">ElementBasis.LAGRANGE</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.ElementBasis.SERENDIPITY"><code class="docutils literal notranslate"><span class="pre">ElementBasis.SERENDIPITY</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.ElementBasis.NONCONFORMING_POLYNOMIAL"><code class="docutils literal notranslate"><span class="pre">ElementBasis.NONCONFORMING_POLYNOMIAL</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.SymmetricTensorMapper"><code class="docutils literal notranslate"><span class="pre">SymmetricTensorMapper</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SkewSymmetricTensorMapper"><code class="docutils literal notranslate"><span class="pre">SkewSymmetricTensorMapper</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.PointBasisSpace"><code class="docutils literal notranslate"><span class="pre">PointBasisSpace</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fields">Fields</a><ul>
<li><a class="reference internal" href="#warp.fem.make_test"><code class="docutils literal notranslate"><span class="pre">make_test()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.make_trial"><code class="docutils literal notranslate"><span class="pre">make_trial()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.make_restriction"><code class="docutils literal notranslate"><span class="pre">make_restriction()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a><ul>
<li><a class="reference internal" href="#warp.fem.normalize_dirichlet_projector"><code class="docutils literal notranslate"><span class="pre">normalize_dirichlet_projector()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.project_linear_system"><code class="docutils literal notranslate"><span class="pre">project_linear_system()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">Memory management</a><ul>
<li><a class="reference internal" href="#warp.fem.set_default_temporary_store"><code class="docutils literal notranslate"><span class="pre">set_default_temporary_store()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.borrow_temporary"><code class="docutils literal notranslate"><span class="pre">borrow_temporary()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.borrow_temporary_like"><code class="docutils literal notranslate"><span class="pre">borrow_temporary_like()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#interfaces">Interfaces</a><ul>
<li><a class="reference internal" href="#warp.fem.Geometry"><code class="docutils literal notranslate"><span class="pre">Geometry</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.Geometry.cell_count"><code class="docutils literal notranslate"><span class="pre">Geometry.cell_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Geometry.side_count"><code class="docutils literal notranslate"><span class="pre">Geometry.side_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Geometry.boundary_side_count"><code class="docutils literal notranslate"><span class="pre">Geometry.boundary_side_count()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.GeometryPartition"><code class="docutils literal notranslate"><span class="pre">GeometryPartition</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.GeometryPartition.cell_count"><code class="docutils literal notranslate"><span class="pre">GeometryPartition.cell_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.GeometryPartition.side_count"><code class="docutils literal notranslate"><span class="pre">GeometryPartition.side_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.GeometryPartition.boundary_side_count"><code class="docutils literal notranslate"><span class="pre">GeometryPartition.boundary_side_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.GeometryPartition.frontier_side_count"><code class="docutils literal notranslate"><span class="pre">GeometryPartition.frontier_side_count()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.GeometryDomain"><code class="docutils literal notranslate"><span class="pre">GeometryDomain</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.GeometryDomain.ElementKind"><code class="docutils literal notranslate"><span class="pre">GeometryDomain.ElementKind</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.GeometryDomain.element_kind"><code class="docutils literal notranslate"><span class="pre">GeometryDomain.element_kind</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.GeometryDomain.dimension"><code class="docutils literal notranslate"><span class="pre">GeometryDomain.dimension</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.GeometryDomain.element_count"><code class="docutils literal notranslate"><span class="pre">GeometryDomain.element_count()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.Quadrature"><code class="docutils literal notranslate"><span class="pre">Quadrature</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.Quadrature.domain"><code class="docutils literal notranslate"><span class="pre">Quadrature.domain</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.Quadrature.total_point_count"><code class="docutils literal notranslate"><span class="pre">Quadrature.total_point_count()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.FunctionSpace"><code class="docutils literal notranslate"><span class="pre">FunctionSpace</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.FunctionSpace.dtype"><code class="docutils literal notranslate"><span class="pre">FunctionSpace.dtype</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FunctionSpace.topology"><code class="docutils literal notranslate"><span class="pre">FunctionSpace.topology</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FunctionSpace.geometry"><code class="docutils literal notranslate"><span class="pre">FunctionSpace.geometry</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FunctionSpace.dimension"><code class="docutils literal notranslate"><span class="pre">FunctionSpace.dimension</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FunctionSpace.degree"><code class="docutils literal notranslate"><span class="pre">FunctionSpace.degree</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FunctionSpace.trace"><code class="docutils literal notranslate"><span class="pre">FunctionSpace.trace()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FunctionSpace.make_field"><code class="docutils literal notranslate"><span class="pre">FunctionSpace.make_field()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.SpaceTopology"><code class="docutils literal notranslate"><span class="pre">SpaceTopology</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.SpaceTopology.dimension"><code class="docutils literal notranslate"><span class="pre">SpaceTopology.dimension</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpaceTopology.geometry"><code class="docutils literal notranslate"><span class="pre">SpaceTopology.geometry</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpaceTopology.node_count"><code class="docutils literal notranslate"><span class="pre">SpaceTopology.node_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpaceTopology.element_node_indices"><code class="docutils literal notranslate"><span class="pre">SpaceTopology.element_node_indices()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpaceTopology.trace"><code class="docutils literal notranslate"><span class="pre">SpaceTopology.trace()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.BasisSpace"><code class="docutils literal notranslate"><span class="pre">BasisSpace</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.BasisSpace.topology"><code class="docutils literal notranslate"><span class="pre">BasisSpace.topology</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.BasisSpace.geometry"><code class="docutils literal notranslate"><span class="pre">BasisSpace.geometry</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.BasisSpace.node_positions"><code class="docutils literal notranslate"><span class="pre">BasisSpace.node_positions()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.space.shape.ShapeFunction"><code class="docutils literal notranslate"><span class="pre">ShapeFunction</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpacePartition"><code class="docutils literal notranslate"><span class="pre">SpacePartition</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.SpacePartition.node_count"><code class="docutils literal notranslate"><span class="pre">SpacePartition.node_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpacePartition.owned_node_count"><code class="docutils literal notranslate"><span class="pre">SpacePartition.owned_node_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpacePartition.interior_node_count"><code class="docutils literal notranslate"><span class="pre">SpacePartition.interior_node_count()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.SpacePartition.space_node_indices"><code class="docutils literal notranslate"><span class="pre">SpacePartition.space_node_indices()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.SpaceRestriction"><code class="docutils literal notranslate"><span class="pre">SpaceRestriction</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.DofMapper"><code class="docutils literal notranslate"><span class="pre">DofMapper</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.FieldLike"><code class="docutils literal notranslate"><span class="pre">FieldLike</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.DiscreteField"><code class="docutils literal notranslate"><span class="pre">DiscreteField</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.DiscreteField.dof_values"><code class="docutils literal notranslate"><span class="pre">DiscreteField.dof_values</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.DiscreteField.trace"><code class="docutils literal notranslate"><span class="pre">DiscreteField.trace()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.DiscreteField.make_deformed_geometry"><code class="docutils literal notranslate"><span class="pre">DiscreteField.make_deformed_geometry()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#warp.fem.field.FieldRestriction"><code class="docutils literal notranslate"><span class="pre">FieldRestriction</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.field.SpaceField"><code class="docutils literal notranslate"><span class="pre">SpaceField</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.field.TestField"><code class="docutils literal notranslate"><span class="pre">TestField</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.field.TrialField"><code class="docutils literal notranslate"><span class="pre">TrialField</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.TemporaryStore"><code class="docutils literal notranslate"><span class="pre">TemporaryStore</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.cache.Temporary"><code class="docutils literal notranslate"><span class="pre">Temporary</span></code></a><ul>
<li><a class="reference internal" href="#warp.fem.cache.Temporary.detach"><code class="docutils literal notranslate"><span class="pre">Temporary.detach()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.cache.Temporary.release"><code class="docutils literal notranslate"><span class="pre">Temporary.release()</span></code></a></li>
<li><a class="reference internal" href="#warp.fem.cache.Temporary.array"><code class="docutils literal notranslate"><span class="pre">Temporary.array</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=1ed6394b"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=fd10adb8"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>